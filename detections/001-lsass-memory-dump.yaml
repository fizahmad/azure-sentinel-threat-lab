id: 001-lsass-memory-dump
name: LSASS Memory Dump Detected
description: Catches processes accessing lsass.exe memory - credential dumping technique used by mimikatz, procdump etc.
severity: High
status: Available
requiredDataConnectors:
- connectorId: AzureMonitorWindowsAgents
  dataTypes: [ SysmonEvent ]
tactics: [ CredentialAccess ]
techniques: [ T1003.001 ]
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
kind: Scheduled
query: |-
  SysmonEvent
  | where TimeGenerated >= ago(1h)
  | where EventID == 10
  | where TargetImage endswith "lsass. exe"
  | where not(Process has_any ("taskmgr.exe", "lsass.exe", "MsMpEng.exe"))
  | project TimeGenerated, Computer, User, Process, TargetImage, CallTrace
version: 1.0.0
tags:
- T1003.001
- CredentialDumping
